<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finding | Cloud Services LLC</title>
    <link rel="icon" href="assets/favicon.png" sizes="144x144" type="image/png">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
        .post-layout {
            display: grid;
            grid-template-columns: 240px 1fr;
            gap: 40px;
            align-items: start;
            max-width: 1100px;
            margin: 0 auto;
        }

        /* ‚îÄ‚îÄ TOC sidebar ‚îÄ‚îÄ */
        .toc-container {
            position: sticky;
            top: 120px;
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }
        .toc-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--accent-color);
            margin-bottom: 14px;
        }
        .toc-list {
            list-style: none;
            padding: 0;
            margin: 0;
            font-size: 0.875rem;
        }
        .toc-list li {
            margin-bottom: 8px;
            line-height: 1.4;
        }
        .toc-list a {
            text-decoration: none;
            color: var(--text-secondary);
            transition: color 0.2s;
            display: block;
        }
        .toc-list a:hover,
        .toc-list a.active {
            color: var(--accent-color);
        }
        .toc-list .toc-h3 {
            padding-left: 14px;
            font-size: 0.82rem;
        }
        .toc-empty {
            font-size: 0.82rem;
            color: var(--text-secondary);
            opacity: 0.6;
            font-style: italic;
        }

        /* ‚îÄ‚îÄ Article card ‚îÄ‚îÄ */
        #content {
            line-height: 1.85;
            font-size: 1rem;
        }

        /* ‚îÄ‚îÄ Post title at top ‚îÄ‚îÄ */
        .post-title-bar {
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        .post-title-bar h1 {
            font-size: 1.9rem;
            font-weight: 800;
            margin: 0 0 8px;
            line-height: 1.3;
        }
        .post-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* ‚îÄ‚îÄ Readable link colors inside post ‚îÄ‚îÄ */
        #content a {
            color: #60a5fa;
            text-decoration: underline;
            text-decoration-color: rgba(96, 165, 250, 0.4);
            text-underline-offset: 3px;
            transition: color 0.2s, text-decoration-color 0.2s;
        }
        #content a:hover {
            color: #93c5fd;
            text-decoration-color: rgba(147, 197, 253, 0.7);
        }
        body:not(.dark) #content a {
            color: #2563eb;
            text-decoration-color: rgba(37, 99, 235, 0.35);
        }
        body:not(.dark) #content a:hover {
            color: #1d4ed8;
            text-decoration-color: rgba(29, 78, 216, 0.6);
        }

        /* ‚îÄ‚îÄ Headings inside post ‚îÄ‚îÄ */
        #content h2 {
            font-size: 1.35rem;
            font-weight: 700;
            margin: 36px 0 12px;
            padding-bottom: 6px;
            border-bottom: 1px solid var(--border-color);
        }
        #content h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin: 24px 0 10px;
        }
        #content p { margin: 0 0 16px; }
        #content ul, #content ol {
            padding-left: 24px;
            margin-bottom: 16px;
        }
        #content li { margin-bottom: 6px; }
        #content code {
            font-family: 'Courier New', monospace;
            font-size: 0.88em;
            background: rgba(99, 179, 237, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }
        #content pre {
            background: rgba(0,0,0,0.3);
            padding: 16px;
            border-radius: 10px;
            overflow-x: auto;
            margin-bottom: 16px;
        }
        #content pre code {
            background: none;
            padding: 0;
        }
        body:not(.dark) #content pre {
            background: rgba(0,0,0,0.06);
        }

        /* ‚îÄ‚îÄ Back link ‚îÄ‚îÄ */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--accent-color);
            text-decoration: none;
            margin-bottom: 24px;
            opacity: 0.8;
            transition: opacity 0.2s;
        }
        .back-link:hover { opacity: 1; }

        @media (max-width: 900px) {
            .post-layout { grid-template-columns: 1fr; }
            .toc-container { display: none; }
        }
    </style>
</head>
<body class="dark">
    <script>
        (function() {
            const saved = localStorage.getItem('theme') || 'dark';
            if (saved === 'light') {
                document.body.classList.remove('dark');
            } else {
                document.body.classList.add('dark');
            }
        })();
    </script>

<header class="navbar">
    <div class="nav-container">
        <a href="index.html" class="logo-link">
            <img src="assets/logo1.png" class="logo-img" alt="Cloud Services LLC Logo">
            <div class="logo-text-stack">
                <span class="logo-title">Cloud Services</span>
                <span class="logo-subtitle">LLC</span>
            </div>
        </a>
        <nav class="nav-links">
            <a href="index.html#about">About</a>
            <a href="index.html#services">Services</a>
            <a href="index.html#skills">Tech Stack</a>
            <a href="projects.html">Projects</a>
            <a href="blog.html">Blog / Findings</a>
            <a href="contact.html" class="btn-primary">Contact</a>
            <button id="modeToggle" aria-label="Toggle Dark Mode">
                <span class="icon-sun">‚òÄÔ∏è</span>
                <span class="icon-moon">üåô</span>
            </button>
        </nav>
        <button class="mobile-menu-btn" aria-label="Menu">‚ò∞</button>
    </div>
</header>

<main class="section" style="margin-top: var(--header-height);">
    <a href="blog.html" class="back-link">‚Üê Back to Findings</a>

    <div class="post-layout">
        <!-- TOC sidebar -->
        <aside class="toc-container">
            <div class="toc-title">On This Page</div>
            <ul id="toc" class="toc-list">
                <li><span class="toc-empty">Loading‚Ä¶</span></li>
            </ul>
        </aside>

        <!-- Post content -->
        <article id="content" class="card">
            <p>Loading report findings‚Ä¶</p>
        </article>
    </div>
</main>

<script src="js/main.js"></script>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const fileName  = urlParams.get('file');

    async function loadPost() {
        const contentDiv = document.getElementById('content');
        const tocList    = document.getElementById('toc');

        if (!fileName) {
            contentDiv.innerHTML = '<p>No post specified.</p>';
            tocList.innerHTML = '';
            return;
        }

        try {
            const repo   = "SridharRenangi/cloudservicesllc-site";
            const rawUrl = `https://raw.githubusercontent.com/${repo}/main/blog/${fileName}`;
            const response = await fetch(rawUrl);
            if (!response.ok) throw new Error('Not found');
            const markdown = await response.text();

            // ‚îÄ‚îÄ Strip frontmatter and extract metadata ‚îÄ‚îÄ
            let title = '';
            let date  = '';
            const fmMatch = markdown.match(/^---\r?\n([\s\S]*?)\r?\n---/);
            let body = markdown;
            if (fmMatch) {
                const fm = fmMatch[1];
                const titleMatch = fm.match(/^title:\s*(.+)/m);
                const dateMatch  = fm.match(/^date:\s*(.+)/m);
                if (titleMatch) title = titleMatch[1].trim().replace(/^['"]|['"]$/g, '');
                if (dateMatch)  date  = dateMatch[1].trim();
                body = markdown.slice(fmMatch[0].length).trim();
            }

            // Fallback title from filename
            if (!title) {
                title = fileName
                    .replace('.md', '')
                    .substring(11)
                    .replace(/-/g, ' ')
                    .replace(/\b\w/g, c => c.toUpperCase());
            }
            // Fallback date from filename
            if (!date) date = fileName.substring(0, 10);

            // Strip leading H1 from body to avoid duplicate title
            body = body.replace(/^#\s+.+\r?\n?/, '').trim();

            // Format date safely
            let prettyDate = date;
            try {
                const parts = date.substring(0, 10).split('-');
                const dateObj = new Date(
                    parseInt(parts[0]),
                    parseInt(parts[1]) - 1,
                    parseInt(parts[2])
                );
                if (!isNaN(dateObj.getTime())) {
                    prettyDate = dateObj.toLocaleDateString('en-US', {
                        year: 'numeric', month: 'long', day: 'numeric'
                    });
                }
            } catch(e) { /* keep raw date string */ }

            // Update page title
            document.title = `${title} | Cloud Services LLC`;

            // ‚îÄ‚îÄ Render markdown ‚îÄ‚îÄ
            contentDiv.innerHTML = `
                <div class="post-title-bar">
                    <h1>${title}</h1>
                    <span class="post-meta">${prettyDate}</span>
                </div>
                ${marked.parse(body)}
            `;

            // ‚îÄ‚îÄ Make all links open in a new tab ‚îÄ‚îÄ
            contentDiv.querySelectorAll('a').forEach(link => {
                link.setAttribute('target', '_blank');
                link.setAttribute('rel', 'noopener noreferrer');
            });

            // ‚îÄ‚îÄ Build TOC from rendered headings ‚îÄ‚îÄ
            tocList.innerHTML = '';
            const headings = contentDiv.querySelectorAll('h1, h2, h3');

            if (headings.length === 0) {
                tocList.innerHTML = '<li><span class="toc-empty">No sections found</span></li>';
            } else {
                headings.forEach((heading, index) => {
                    const id = `section-${index}`;
                    heading.setAttribute('id', id);

                    const li = document.createElement('li');
                    if (heading.tagName === 'H3') li.classList.add('toc-h3');
                    li.innerHTML = `<a href="#${id}">${heading.innerText}</a>`;
                    tocList.appendChild(li);
                });
            }

            // ‚îÄ‚îÄ Highlight active TOC item on scroll ‚îÄ‚îÄ
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    const id = entry.target.getAttribute('id');
                    const link = tocList.querySelector(`a[href="#${id}"]`);
                    if (link) link.classList.toggle('active', entry.isIntersecting);
                });
            }, { rootMargin: '-20% 0px -70% 0px' });

            headings.forEach(h => observer.observe(h));

        } catch (err) {
            document.getElementById('content').innerHTML = '<p>Unable to load the requested report. Please try again later.</p>';
            document.getElementById('toc').innerHTML = '';
        }
    }

    loadPost();
</script>
</body>
</html>